/* https://www.github.com/jas-/jQuery.pidCrypt */
(function(a){a.fn.pidCrypt=function(b){var e=e||{appID:"jQuery.pidCrypt",storage:"local",formID:a(this),type:"json",aes:"",keys:{},use:"",callback:function(){},preCallback:function(){},errCallback:function(){}};var d=d||{init:function(l){var k=c.__setup(l,e);a("#"+k.formID.attr("id")).on("submit",function(m){m.preventDefault();c.__do(k,c.__gF(k))});return true}};var c=c||{__do:function(m,k){var l=(typeof k=="object")?j.__serialize(k):k;a.ajax({form:m.formID.attr("id"),url:m.formID.attr("action"),type:m.formID.attr("method"),data:l,crossDomain:(m.type==="jsonp")?true:false,beforeSend:function(n){n.setRequestHeader("X-Alt-Referer",m.appID);if(h.__vStr(l)){n.setRequestHeader("Content-MD5",pidCryptUtil.encodeBase64(pidCrypt.MD5(l)))}else{n.setRequestHeader("Content-MD5",pidCryptUtil.encodeBase64(pidCrypt.MD5(m.appID)))}((m.preCallback)&&(a.isFunction(m.preCallback)))?m.preCallback(n):false},success:function(n,o,p){((m.callback)&&(a.isFunction(m.callback)))?m.callback.call(n):console.log(n)},error:function(p,n,o){((m.errCallback)&&(a.isFunction(m.errCallback)))?m.errCallback.call(p,n,o):false}})},__setup:function(m,l){var k=a.extend({},l,m);k.aes=g.__sAES();k.keys=i.__existing(k);if(h.__szCk(k.keys)<=0){i.__hK(k)}k.use=i.__sK(k);return k},__gF:function(l){var k={};a.each(a("#"+l.formID.attr("id")+" :input, input:radio:selected, input:checkbox:checked, textarea"),function(n,m){if((h.__vStr(m.value))&&(h.__vStr(m.name))){k[m.name]=(parseInt(m.value.length)>80)?j.__sSplt(m.value):m.value}});return g.__eO(l,k)}};var i=i||{__hK:function(k){var l=function(){var r=(this)?JSON.parse(this):false;var m=((r)&&(r.email))?r.email:k.appID;var n=((r)&&(r.key))?r.key:false;if(!n){return false}var q=i.__gUUID(null);var o={};o[q]={};o[q]["email"]=encodeURI(k.aes.encryptText(m,q,{nBits:256,salt:i.__strIV(q)}));o[q]["key"]=encodeURI(k.aes.encryptText(n,q,{nBits:256,salt:i.__strIV(q)}));o=a.extend({},o,i.__existing(k));f.__sI(k.storage,i.__id(),JSON.stringify(o))};k.callback=l;c.__do(k,{key:true});return true},__sK:function(l){var k=false;if(h.__szCk(l.keys)>0){a.each(l.keys,function(o,n){var p=new RegExp("/[0-9a-z-_.]{2,45}@[0-9a-z-_.]{2,45}.[a-z]{2,4}/gi");var m=l.aes.decryptText(decodeURI(n.email),o,{nBits:256,salt:i.__strIV(o)});if(p.test(m)){return l.aes.decryptText(decodeURI(n.key),o,{nBits:256,salt:i.__strIV(o)})}else{k=l.aes.decryptText(decodeURI(n.key),o,{nBits:256,salt:i.__strIV(o)})}})}return k},__existing:function(k){return(f.__gI(k.storage,i.__id()))?JSON.parse(f.__gI(k.storage,i.__id())):false},__id:function(){return(h.__vStr(location.host))?location.host:(h.__vStr(location.hostname))?location.hostname:"localhost"},__gUUID:function(k){var p="0123456789abcdef".split("");var n=[],m=Math.random,o;n[8]=n[13]=n[18]=n[23]="-";n[14]="4";for(var l=0;l<36;l++){if(!n[l]){o=0|m()*16;n[l]=p[(l==19)?(o&3)|8:o&15]}}return(k!==null)?n.join("").replace(/-/g,"").split("",k).join(""):n.join("")},__strIV:function(k){return(k)?encodeURI(k.replace(/-/gi,"").substring(16,Math.ceil(16*k.length)%k.length)):false}};var g=g||{__eO:function(m,l){var k={};var n=g.__certParser(m.use);g.__iP(n);if(h.__szCk(l)>0){a.each(l,function(p,o){if(typeof o==="object"){k[p]={};a.each(o,function(r,q){k[p][r]=pidCrypt.RSA.prototype.encrypt(q)})}else{k[p]=pidCrypt.RSA.prototype.encrypt(o)}})}else{k=0}return k},__sAES:function(){return new pidCrypt.AES.CBC()},__iP:function(o){var n=false;if(o.b64){var l=pidCryptUtil.decodeBase64(o.b64);n=new pidCrypt();var m=pidCrypt.ASN1.decode(pidCryptUtil.toByteArray(l));var k=m.toHexTree();pidCrypt.RSA.prototype.setPublicKeyFromASN(k)}return n},__certParser:function(p){if(!p){return false}var u=p.split("\n");var k=false;var l=false;var m=false;var r="";var n={};n.info="";n.salt="";n.iv;n.b64="";n.aes=false;n.mode="";n.bits=0;for(var q=0;q<u.length;q++){r=u[q].substr(0,9);if(q==1&&r!="Proc-Type"&&r.indexOf("M")==0){l=true}switch(r){case"-----BEGI":k=true;break;case"Proc-Type":if(k){n.info=u[q]}break;case"DEK-Info:":if(k){var o=u[q].split(",");var t=o[0].split(": ");var s=t[1].split("-");n.aes=(s[0]=="AES")?true:false;n.mode=s[2];n.bits=parseInt(s[1]);n.salt=o[1].substr(0,16);n.iv=o[1]}break;case"":if(k){l=true}break;case"-----END ":if(k){l=false;k=false}break;default:if(k&&l){n.b64+=pidCryptUtil.stripLineFeeds(u[q])}}}return n}};var j=j||{__serialize:function(l){if(h.__szCk(l)>0){var k="";a.each(l,function(n,m){if(typeof m==="object"){a.each(m,function(p,o){k+=n+"["+p+"]="+o+"&"})}else{k+=n+"="+m+"&"}});k=k.substring(0,k.length-1)}else{return false}return k},__sSplt:function(o){var m=o.length/80;var p={};var k=0;var n=80;for(var l=0;l<m;l++){if(l>0){k=k+80;n=n+80}if(o.slice(k,n).length>0){p[l]=o.slice(k,n)}}return p}};var f=f||{__sI:function(o,n,m){var l=false;o=(h.__vStore(o+"Storage"))?o:"cookie";switch(o){case"local":l=this.__sL(n,m);break;case"session":l=this.__sS(n,m);break;case"cookie":l=this.__sC(n,m);break;default:l=this.__sL(n,m);break}return l},__gI:function(n,m){var l=false;n=(h.__vStore(n+"Storage"))?n:"cookie";switch(n){case"local":l=this.__gL(m);break;case"session":l=this.__gS(m);break;case"cookie":l=this.__gC(m);break;default:l=this.__gL(m);break}return l},__dI:function(n,m){var l=false;n=(h.__vStore(n+"Storage"))?n:"cookie";switch(n){case"local":l=this.__dL(m);break;case"session":l=this.__dS(m);break;case"cookie":l=this.__dC(m);break;default:l=this.__dL(m);break}return l},__sL:function(m,l){return(localStorage.setItem(m,l))?false:true},__sS:function(m,l){return(sessionStorage.setItem(m,l))?false:true},__sC:function(m,l){if(typeof a.cookie==="function"){return(a.cookie(m,l,{expires:7}))?true:false}else{return false}},__gL:function(l){return(localStorage.getItem(l))?localStorage.getItem(l):false},__gS:function(l){return(sessionStorage.getItem(l))?sessionStorage.getItem(l):false},__gC:function(k){if(typeof a.cookie==="function"){return(a.cookie(k))?a.cookie(k):false}else{return false}},__dL:function(l){return(localStorage.removeItem(l))?localStorage.removeItem(l):false},__dS:function(l){return(sessionStorage.removeItem(l))?sessionStorage.removeItem(l):false},__dC:function(k){if(typeof a.cookie==="function"){return(a.cookie(k,"",{expires:-7}))?true:false}else{return false}}};var h=h||{__vStr:function(k){return((k===false)||(k.length===0)||(!k)||(k===null)||(k==="")||(typeof k==="undefined"))?false:true},__vStore:function(k){try{return((k in window)&&(window[k]))?true:false}catch(l){return false}},__szCk:function(k){var l=0;a.each(k,function(n,m){if(k.hasOwnProperty(n)){l++}});return l}};if(d[b]){return d[b].apply(this,Array.prototype.slice.call(arguments,1))}else{if((typeof b==="object")||(!b)){return d.init.apply(this,arguments)}else{console.log("Method "+b+" does not exist")}}}})(jQuery);